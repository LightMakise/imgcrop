(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,function(t,e,i){t.exports=i(20)},,,,,,function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){"use strict";i.r(e);var s=i(0),o=i.n(s),n=i(7),a=i.n(n),l=(i(14),i(15),i(1)),h=i(2),r=i(4),c=i(3),u=i(5),g=(i(16),i(17),i(18),function(t){function e(t){var i;return Object(l.a)(this,e),(i=Object(r.a)(this,Object(c.a)(e).call(this,t))).cutMoving=!1,i.stretchMoving=!1,i.stratPosition={x:0,y:0},i.translate={x:0,y:0},i.style={width:50,height:50,left:0,top:0},i.canvasSource=document.createElement("canvas"),i.init(),i.state={style:i.style,cutImgUrl:""},document.addEventListener("mouseup",function(){i.cutMoving=!1,i.stretchMoving=!1,i.cutImg(i.props.imgUrl)}),i}return Object(u.a)(e,t),Object(h.a)(e,[{key:"init",value:function(){this.cutMoving=!1,this.stretchMoving=!1,this.style={width:50,height:50,left:0,top:0},this.stratPosition={x:0,y:0},this.translate={x:0,y:0},this.setState({style:this.style,cutImgUrl:""})}},{key:"getCutDomPosition",value:function(){var t=document.querySelector(".cut"),e=t.offsetWidth||this.style.width,i=t.offsetHeight||this.style.height,s=t.offsetLeft||this.style.left,o=t.offsetTop||this.style.top;return{width:e,height:i,left:s,top:o,right:s+e,bottom:o+i}}},{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(t){t.showCut&&""!==t.imgUrl&&this.cutImg(t.imgUrl)}},{key:"cutMouseDown",value:function(t,e){this.cutMoving=!0}},{key:"cutMouseMove",value:function(t,e){this.cutMoving&&(this.translate={x:e.movementX,y:e.movementY},this.move())}},{key:"cutMouseUp",value:function(t,e){this.cutMoving=!1}},{key:"stretchMouseDown",value:function(t,e){this.stretchMoving=!0,this.stratPosition={x:e.clientX,y:e.clientY},e.stopPropagation()}},{key:"stretchMouseMove",value:function(t,e){e.stopPropagation(),this.stretchMoving&&this.stretchCutDom(e.movementX,e.movementY)}},{key:"stretchMouseUp",value:function(t,e){this.stretchMoving=!1,e.stopPropagation()}},{key:"stretchCutDom",value:function(t,e){var i=this.getCutDomPosition();console.log("this.props.limit",this.props.limit),this.style.width+=t,this.style.height+=e,i.right>this.props.limit.width-5&&(this.style.width=this.props.limit.width-i.left-5),i.bottom>this.props.limit.height-5&&(this.style.height=this.props.limit.height-i.top-5),this.setState({style:this.style}),this.cutImg(this.props.imgUrl)}},{key:"move",value:function(){var t=this.getCutDomPosition();this.style.left+=this.translate.x,this.style.top+=this.translate.y,this.style.left<0&&(this.style.left=0),this.style.left+t.width>=this.props.limit.width-4&&(this.style.left=this.props.limit.width-t.width-4),this.style.top<0&&(this.style.top=0),this.style.top+t.height>=this.props.limit.height-4&&(this.style.top=this.props.limit.height-t.height-4),this.setState({style:this.style}),this.cutImg(this.props.imgUrl)}},{key:"cutImg",value:function(t){var e=this,i=this.getCutDomPosition(),s=this.canvasSource,o=document.querySelector("#result");s.width=this.props.limit.width,s.height=this.props.limit.height,o.width=i.width,o.height=i.height;var n=s.getContext("2d"),a=o.getContext("2d"),l=new Image;l.src=t,l.width=s.width,l.height=s.height,l.onload=function(){n.drawImage(l,0,0,s.width,s.height);var t=n.getImageData(i.left,i.top,o.width,o.height);a.putImageData(t,0,0,0,0,o.width,o.height);var h=o.toDataURL("image/png");e.setState({cutImgUrl:h})}}},{key:"cutImgMouseDown",value:function(t,e){e.preventDefault()}},{key:"cutImgMouseMove",value:function(t,e){e.preventDefault()}},{key:"cutImgMouseUp",value:function(t,e){e.preventDefault()}},{key:"render",value:function(t){return o.a.createElement("div",{className:"cut ".concat(this.props.showCut?"":"hide"),onMouseDown:this.cutMouseDown.bind(this,t),onMouseMove:this.cutMouseMove.bind(this,t),onMouseUp:this.cutMouseUp.bind(this,t),style:{width:this.state.style.width+"px",height:this.state.style.height+"px",left:this.state.style.left+"px",top:this.state.style.top+"px"}},""!==this.state.cutImgUrl?o.a.createElement("img",{src:this.state.cutImgUrl,id:"result_img",onMouseDown:this.cutImgMouseDown.bind(this,t),onMouseMove:this.cutImgMouseMove.bind(this,t),onMouseUp:this.cutImgMouseUp.bind(this,t)}):"",o.a.createElement("div",{className:"stretch l-t",onMouseDown:this.stretchMouseDown.bind(this,t),onMouseMove:this.stretchMouseMove.bind(this,t),onMouseUp:this.stretchMouseUp.bind(this,t)}))}}]),e}(o.a.Component)),m=function(t){function e(t){var i;return Object(l.a)(this,e),console.log("props",t),(i=Object(r.a)(this,Object(c.a)(e).call(this,t))).imgsType=["image/jpeg","image/png"],i.imgsSize=10485760,i.imgReal={width:"auto",height:"auto"},i.state={imgReal:i.imgReal,limit:{},fileEnterArea:!1,imgUrl:"",showCut:!1},i}return Object(u.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){}},{key:"selectFile",value:function(){console.log(this.fileInput),this.fileInput.click()}},{key:"clickFile",value:function(t){this.processFile(this.fileInput.files),this.fileInput.value=""}},{key:"delImg",value:function(){console.log("delImg"),this.cut.init(),this.setState({imgReal:{width:"auto",height:"auto"},imgUrl:"",fileEnterArea:!1,showCut:!1})}},{key:"imgShow",value:function(t){var e=this;this.setState({imgUrl:t,showCut:!0});var i=document.querySelector(".droparea");setTimeout(function(){var t={left:i.offsetLeft,top:i.offsetTop,bottom:i.offsetTop+i.offsetHeight,right:i.offsetLeft+i.offsetWidth,width:i.offsetWidth,height:i.offsetHeight};console.log("limit",t),e.setState({limit:t})}),this.props.loadingImgFinish()}},{key:"processFile",value:function(t){var e=this;if(t=this.getFile(t),console.log("files",t),0!==t.length){var i=new FileReader;i.readAsDataURL(t[0]),console.log("\u5f00\u59cb\u8bfb\u53d6\u6587\u4ef6"),i.onload=function(){console.log("\u6587\u4ef6\u8bfb\u53d6\u5b8c\u6210"),e.imgShow(i.result),e.getImgReal(i.result)}}}},{key:"getImgReal",value:function(t){var e=this,i=new Image;i.src=t,i.onload=function(){e.imgReal.width=i.width+"px",e.imgReal.height=i.height+"px",e.setState({imgReal:e.imgReal})}}},{key:"getFile",value:function(t){var e=this;return Array.from(t).filter(function(t){return e.checkFile(t)})}},{key:"checkFile",value:function(t){var e=t.type,i=t.size,s=!0;return this.imgsType.includes(e)||(s=!1,console.error("\u6587\u4ef6\u4e0d\u662f\u56fe\u7247\u7c7b\u578b ".concat(e))),i>=this.imgsSize&&(s=!1,console.error("\u6587\u4ef6\u8d85\u8fc7".concat(i))),s}},{key:"onDragOver",value:function(t){t.preventDefault()}},{key:"onDrop",value:function(t,e){e.preventDefault(),this.state.imgUrl||(this.setState({fileEnterArea:!1}),console.log("onDrop",t,e),this.processFile(e.dataTransfer.files))}},{key:"onDragEnter",value:function(){this.state.imgUrl||(this.setState({fileEnterArea:!0}),console.log("onDragEnter"))}},{key:"onDragLeave",value:function(){this.state.imgUrl||(this.setState({fileEnterArea:!1}),console.log("onDragLeave"))}},{key:"save",value:function(){var t=document.querySelector("#result_img"),e=document.createElement("a");e.download="\u526a\u88c1\u6587\u4ef6",e.href=t.src,e.dataset.downloadUrl=[e.download,e.href].join(":"),document.body.appendChild(e),e.click(),document.body.removeChild(e)}},{key:"render",value:function(t){var e=this;return o.a.createElement("div",{className:"droparea ".concat(this.state.fileEnterArea?"file-hover":null," ").concat(this.state.showCut?"no-border":null),onDragOver:this.onDragOver.bind(this),onDragEnter:this.onDragEnter.bind(this),onDragLeave:this.onDragLeave.bind(this),onDrop:this.onDrop.bind(this,t),style:{width:this.state.imgReal.width,height:this.state.imgReal.height}},o.a.createElement("input",{className:"hide",type:"file",ref:function(t){return e.fileInput=t},onChange:this.clickFile.bind(this)}),this.state.imgUrl?o.a.createElement("img",{src:this.state.imgUrl,id:"source"}):null,o.a.createElement("div",{className:"layer"}),o.a.createElement(g,{limit:this.state.limit,showCut:this.state.showCut,imgUrl:this.state.imgUrl,ref:function(t){return e.cut=t}}))}}]),e}(o.a.Component),f=(i(19),function(t){function e(t){var i;return Object(l.a)(this,e),(i=Object(r.a)(this,Object(c.a)(e).call(this,t))).state={showDel:!1},i}return Object(u.a)(e,t),Object(h.a)(e,[{key:"delImg",value:function(){this.props.delImg(),this.setState({showDel:!1})}},{key:"save",value:function(){this.props.save()}},{key:"loadingImgFinish",value:function(){this.setState({showDel:!0})}},{key:"selectFile",value:function(){this.props.selectFile()}},{key:"render",value:function(){return o.a.createElement("div",{className:"option"},this.state.showDel?null:o.a.createElement("div",{className:"button",onClick:this.selectFile.bind(this)},"\u9009\u62e9\u4e00\u5f20\u56fe\u7247(\u6216\u8005\u62d6\u62fd\u5230\u4e0a\u65b9)"),this.state.showDel?o.a.createElement("div",{className:"button save",onClick:this.save.bind(this)},"\u4fdd\u5b58"):null,this.state.showDel?o.a.createElement("div",{className:"button del",onClick:this.delImg.bind(this)},"\u6e05\u9664"):null)}}]),e}(o.a.Component)),d=function(t){function e(t){var i;return Object(l.a)(this,e),(i=Object(r.a)(this,Object(c.a)(e).call(this,t))).state={},i}return Object(u.a)(e,t),Object(h.a)(e,[{key:"delImg",value:function(){this.droparea.delImg()}},{key:"save",value:function(){this.droparea.save()}},{key:"loadingImgFinish",value:function(){this.option.loadingImgFinish()}},{key:"selectFile",value:function(){this.droparea.selectFile()}},{key:"render",value:function(t){var e=this;return o.a.createElement("div",{className:"imgcrop"},o.a.createElement(m,{size:10485760,ref:function(t){e.droparea=t},loadingImgFinish:this.loadingImgFinish.bind(this)}),o.a.createElement(f,{selectFile:this.selectFile.bind(this),delImg:this.delImg.bind(this),save:this.save.bind(this),ref:function(t){e.option=t}}))}}]),e}(o.a.Component);var v=function(){return o.a.createElement("div",{className:"App"},o.a.createElement("canvas",{id:"result"},"\u6d4f\u89c8\u5668\u4e0d\u652f\u6301canvas"),o.a.createElement(d,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(o.a.createElement(v,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}],[[8,1,2]]]);
//# sourceMappingURL=main.0ceb5623.chunk.js.map