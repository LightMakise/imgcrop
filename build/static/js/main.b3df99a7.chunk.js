(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(t,e,i){t.exports=i(39)},29:function(t,e,i){},30:function(t,e,i){},31:function(t,e,i){},32:function(t,e,i){},33:function(t,e,i){},34:function(t,e,i){},39:function(t,e,i){"use strict";i.r(e);var n=i(0),s=i.n(n),o=i(20),a=i.n(o);i(29),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=i(2),h=i(3),r=i(5),u=i(4),c=i(6),m=(i(30),i(31),i(32),i(13)),g=(i(33),function(t){function e(t){var i;return Object(l.a)(this,e),(i=Object(r.a)(this,Object(u.a)(e).call(this,t))).cutMoving=!1,i.stretchMoving=!1,i.stratPosition={x:0,y:0},i.translate={x:0,y:0},i.style={width:50,height:50,left:0,top:0},i.canvasSource=document.createElement("canvas"),i.init(),i.state={style:i.style,cutImgUrl:""},document.addEventListener("mouseup",i.mouseupEvent.bind(Object(m.a)(i))),i}return Object(c.a)(e,t),Object(h.a)(e,[{key:"mouseupEvent",value:function(){this.cutMoving=!1,this.stretchMoving=!1,this.cutImg()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mouseup",this.mouseupEvent)}},{key:"init",value:function(){this.cutMoving=!1,this.stretchMoving=!1,this.style={width:50,height:50,left:0,top:0},this.stratPosition={x:0,y:0},this.translate={x:0,y:0},this.setState({style:this.style,cutImgUrl:""})}},{key:"getCutDomPosition",value:function(){var t=document.querySelector(".cut");if(!t)return null;var e=t.offsetWidth||this.style.width,i=t.offsetHeight||this.style.height,n=t.offsetLeft||this.style.left,s=t.offsetTop||this.style.top;return{width:e,height:i,left:n,top:s,right:n+e,bottom:s+i}}},{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(t){t.showCut&&""!==t.imgUrl&&this.cutImg(t.imgUrl)}},{key:"cutMouseDown",value:function(t,e){this.cutMoving=!0}},{key:"cutMouseMove",value:function(t,e){this.cutMoving&&(this.translate={x:e.movementX,y:e.movementY},this.move())}},{key:"cutMouseUp",value:function(t,e){this.cutMoving=!1}},{key:"stretchMouseDown",value:function(t,e){var i=this;this.stretchMoving=!0,this.stratPosition={x:e.pageX,y:e.pageY};var n=function(t){i.stretchMouseMove(t)};document.addEventListener("mousemove",n,!0),document.addEventListener("mouseup",function(){document.removeEventListener("mousemove",n,!0)}),e.stopPropagation()}},{key:"stretchMouseMove",value:function(t){this.stretchCutDom(t.movementX,t.movementY)}},{key:"stretchMouseUp",value:function(t,e){}},{key:"stretchCutDom",value:function(t,e){var i=this.getCutDomPosition();this.style.width+=t,this.style.height+=e,i.right>this.props.limit.width&&(this.style.width=this.props.limit.width-i.left),i.bottom>this.props.limit.height&&(this.style.height=this.props.limit.height-i.top),this.setState({style:this.style}),this.cutImg(this.props.imgUrl)}},{key:"move",value:function(){var t=this.getCutDomPosition();this.style.left+=this.translate.x,this.style.top+=this.translate.y,this.style.left<0&&(this.style.left=0),this.style.left+t.width>=this.props.limit.width&&(this.style.left=this.props.limit.width-t.width),this.style.top<0&&(this.style.top=0),this.style.top+t.height>=this.props.limit.height&&(this.style.top=this.props.limit.height-t.height),this.setState({style:this.style}),this.cutImg(this.props.imgUrl)}},{key:"cutImg",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.imgUrl,i=this.getCutDomPosition();if(i){var n=this.canvasSource,s=document.querySelector("#result");n.width=this.props.limit.width,n.height=this.props.limit.height,s.width=i.width,s.height=i.height;var o=n.getContext("2d"),a=s.getContext("2d"),l=new Image;l.src=e,l.width=n.width,l.height=n.height,l.onload=function(){o.drawImage(l,0,0,n.width,n.height);var e=o.getImageData(i.left,i.top,s.width,s.height);a.putImageData(e,0,0,0,0,s.width,s.height);var h=s.toDataURL("image/png");t.setState({cutImgUrl:h})}}}},{key:"cutImgMouseDown",value:function(t,e){e.preventDefault()}},{key:"cutImgMouseMove",value:function(t,e){e.preventDefault()}},{key:"cutImgMouseUp",value:function(t,e){e.preventDefault()}},{key:"render",value:function(t){return s.a.createElement("div",{className:"cut ".concat(this.props.showCut?"":"hide"),onMouseDown:this.cutMouseDown.bind(this,t),onMouseMove:this.cutMouseMove.bind(this,t),onMouseUp:this.cutMouseUp.bind(this,t),style:{width:this.state.style.width+"px",height:this.state.style.height+"px",left:this.state.style.left+"px",top:this.state.style.top+"px"}},s.a.createElement("div",{className:"size-text"}," ",this.state.style.width+"x"+this.state.style.height),""!==this.state.cutImgUrl?s.a.createElement("img",{src:this.state.cutImgUrl,id:"result_img",onMouseDown:this.cutImgMouseDown.bind(this,t),onMouseMove:this.cutImgMouseMove.bind(this,t),onMouseUp:this.cutImgMouseUp.bind(this,t)}):"",s.a.createElement("div",{className:"stretch l-t",onMouseDown:this.stretchMouseDown.bind(this,t),onMouseUp:this.stretchMouseUp.bind(this,t)}))}}]),e}(s.a.Component)),v=function(t){function e(t){var i;return Object(l.a)(this,e),(i=Object(r.a)(this,Object(u.a)(e).call(this,t))).imgsType=["image/jpeg","image/png"],i.imgsSize=10485760,i.imgReal={width:"auto",height:"auto"},i.state={imgReal:i.imgReal,limit:{},fileEnterArea:!1,imgUrl:"",showCut:!1},i}return Object(c.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){}},{key:"selectFile",value:function(){this.fileInput.click()}},{key:"clickFile",value:function(t){this.processFile(this.fileInput.files),this.fileInput.value=""}},{key:"delImg",value:function(){this.cut.init(),this.setState({imgReal:{width:"auto",height:"auto"},imgUrl:"",fileEnterArea:!1,showCut:!1})}},{key:"imgShow",value:function(t){var e=this;this.setState({imgUrl:t,showCut:!0});var i=document.querySelector(".droparea");setTimeout(function(){var t={left:i.offsetLeft,top:i.offsetTop,bottom:i.offsetTop+i.offsetHeight,right:i.offsetLeft+i.offsetWidth,width:i.offsetWidth,height:i.offsetHeight};e.setState({limit:t})}),this.props.loadingImgFinish()}},{key:"processFile",value:function(t){var e=this;if(0!==(t=this.getFile(t)).length){var i=new FileReader;i.readAsDataURL(t[0]),i.onload=function(){e.imgShow(i.result),e.getImgReal(i.result)}}}},{key:"getImgReal",value:function(t){var e=this,i=new Image;i.src=t,i.onload=function(){e.imgReal.width=i.width+"px",e.imgReal.height=i.height+"px",e.setState({imgReal:e.imgReal})}}},{key:"getFile",value:function(t){var e=this;return Array.from(t).filter(function(t){return e.checkFile(t)})}},{key:"checkFile",value:function(t){var e=t.type,i=t.size,n=!0;return this.imgsType.includes(e)||(n=!1,console.error("\u6587\u4ef6\u4e0d\u662f\u56fe\u7247\u7c7b\u578b ".concat(e))),i>=this.imgsSize&&(n=!1,console.error("\u6587\u4ef6\u8d85\u8fc7".concat(i))),n}},{key:"onDragOver",value:function(t){t.preventDefault()}},{key:"onDrop",value:function(t,e){e.preventDefault(),this.state.imgUrl||(this.setState({fileEnterArea:!1}),this.processFile(e.dataTransfer.files))}},{key:"onDragEnter",value:function(){this.state.imgUrl||this.setState({fileEnterArea:!0})}},{key:"onDragLeave",value:function(){this.state.imgUrl||this.setState({fileEnterArea:!1})}},{key:"save",value:function(){var t=document.querySelector("#result_img"),e=document.createElement("a");e.download="\u526a\u88c1\u6587\u4ef6",e.href=t.src,e.dataset.downloadUrl=[e.download,e.href].join(":"),document.body.appendChild(e),e.click(),document.body.removeChild(e)}},{key:"render",value:function(t){var e=this;return s.a.createElement("div",{className:"droparea ".concat(this.state.fileEnterArea?"file-hover":null," ").concat(this.state.showCut?"no-border":null),onDragOver:this.onDragOver.bind(this),onDragEnter:this.onDragEnter.bind(this),onDragLeave:this.onDragLeave.bind(this),onDrop:this.onDrop.bind(this,t),style:{width:this.state.imgReal.width,height:this.state.imgReal.height}},s.a.createElement("input",{className:"hide",type:"file",ref:function(t){return e.fileInput=t},onChange:this.clickFile.bind(this)}),this.state.imgUrl?s.a.createElement("img",{src:this.state.imgUrl,id:"source"}):null,s.a.createElement("div",{className:"layer"}),s.a.createElement(g,{limit:this.state.limit,showCut:this.state.showCut,imgUrl:this.state.imgUrl,ref:function(t){return e.cut=t}}))}}]),e}(s.a.Component),f=(i(34),function(t){function e(t){var i;return Object(l.a)(this,e),(i=Object(r.a)(this,Object(u.a)(e).call(this,t))).state={showDel:!1},i}return Object(c.a)(e,t),Object(h.a)(e,[{key:"delImg",value:function(){this.props.delImg(),this.setState({showDel:!1})}},{key:"save",value:function(){this.props.save()}},{key:"loadingImgFinish",value:function(){this.setState({showDel:!0})}},{key:"selectFile",value:function(){this.props.selectFile()}},{key:"render",value:function(){return s.a.createElement("div",{className:"option"},this.state.showDel?null:s.a.createElement("div",{className:"button",onClick:this.selectFile.bind(this)},"\u9009\u62e9\u4e00\u5f20\u56fe\u7247(\u6216\u8005\u62d6\u62fd\u5230\u4e0a\u65b9)"),this.state.showDel?s.a.createElement("div",{className:"button save",onClick:this.save.bind(this)},"\u4fdd\u5b58"):null,this.state.showDel?s.a.createElement("div",{className:"button del",onClick:this.delImg.bind(this)},"\u6e05\u9664"):null)}}]),e}(s.a.Component)),d=function(t){function e(t){var i;return Object(l.a)(this,e),(i=Object(r.a)(this,Object(u.a)(e).call(this,t))).state={},i}return Object(c.a)(e,t),Object(h.a)(e,[{key:"componentWillMount",value:function(){}},{key:"delImg",value:function(){this.droparea.delImg()}},{key:"save",value:function(){this.droparea.save()}},{key:"loadingImgFinish",value:function(){this.option.loadingImgFinish()}},{key:"selectFile",value:function(){this.droparea.selectFile()}},{key:"render",value:function(t){var e=this;return s.a.createElement("div",{className:"imgcrop"},s.a.createElement(v,{size:10485760,ref:function(t){e.droparea=t},loadingImgFinish:this.loadingImgFinish.bind(this)}),s.a.createElement(f,{selectFile:this.selectFile.bind(this),delImg:this.delImg.bind(this),save:this.save.bind(this),ref:function(t){e.option=t}}))}}]),e}(s.a.Component),p=function(t){function e(t){var i;return Object(l.a)(this,e),i=Object(r.a)(this,Object(u.a)(e).call(this,t)),console.log(i.props),i}return Object(c.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){return s.a.createElement("div",{className:"imgcrop-page"},s.a.createElement("canvas",{id:"result"},"\u6d4f\u89c8\u5668\u4e0d\u652f\u6301canvas"),s.a.createElement(d,null))}}]),e}(s.a.Component),y=i(7),w=function(t){function e(t){return Object(l.a)(this,e),Object(r.a)(this,Object(u.a)(e).call(this,t))}return Object(c.a)(e,t),Object(h.a)(e,[{key:"push",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/";Object(y.b)().push(t)}}]),e}(s.a.Component),b=function(t){function e(t){return Object(l.a)(this,e),Object(r.a)(this,Object(u.a)(e).call(this,t))}return Object(c.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return s.a.createElement("div",{className:"imgwall"})}}]),e}(w),k=function(t){function e(t){return Object(l.a)(this,e),Object(r.a)(this,Object(u.a)(e).call(this,t))}return Object(c.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return s.a.createElement("div",{className:"Imgwall-page"},s.a.createElement(b,null))}}]),e}(w),M=i(10),E=i(23),D=[{path:"/imgcrop",component:p},{path:"/imgwall",component:k}],O=function(){return s.a.createElement(M.d,null,D.map(function(t,e){return s.a.createElement(M.b,{path:t.path,component:t.component,key:e})}),s.a.createElement(M.a,{from:"/",to:"/imgcrop"}))},j=function(){return s.a.createElement(E.a,null,s.a.createElement(O,null))};a.a.render(s.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[24,1,2]]]);
//# sourceMappingURL=main.b3df99a7.chunk.js.map